#!/usr/bin/env node

var _fs = require('fs'),
    _path = require('path');

function get_list_contents(list, handler) {
  var data = [];
  var iter;
  for ( var i = 0; i < list.length; i++ ) {
    iter = list[i].replace("%HANDLER%", handler);
    var src = _fs.readFileSync(iter);
    console.log(iter);
    if ( src !== null ) {
      data.push(src);
    }
  }
  return data.join("\n");
}

var buildData = JSON.parse(_fs.readFileSync("src/build.json"));
if ( buildData !== null ) {
  var handler = buildData.handler || "demo";
  _fs.writeFileSync(buildData.javascript.output, get_list_contents(buildData.javascript.files, handler));
  _fs.writeFileSync(buildData.stylesheets.output, get_list_contents(buildData.stylesheets.files, handler));
}
